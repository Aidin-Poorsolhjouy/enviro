"use strict";(self.webpackChunkEVC_UI_Web_Admin=self.webpackChunkEVC_UI_Web_Admin||[]).push([[591],{1720:(v,d,i)=>{i.d(d,{z:()=>m});var c=i(3458),f=i(7587),t=i(520);let m=(()=>{class s extends c.f{constructor(l){super(l),this._apiPrefix="organizations"}getAllOrganizations(l){const u=`${this._apiPrefix}${this.getObjectQueryParams(Object.assign(Object.assign({},null==l?void 0:l.filters),null==l?void 0:l.includes))}`;return this.get(u)}getOrganization(l,u){const _=`${this._apiPrefix}/${l}${this.getObjectQueryParams(u)}`;return this.get(_)}addOrganization(l){return this.post(this._apiPrefix,l)}updateOrganization(l,u){return this.put(`${this._apiPrefix}/${l}`,u)}deleteOrganization(l){return this.delete(`${this._apiPrefix}/${l}`)}}return s.\u0275fac=function(l){return new(l||s)(f.LFG(t.eN))},s.\u0275prov=f.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},591:(v,d,i)=>{i.r(d),i.d(d,{OrganizationsModule:()=>q});var c=i(9808),f=i(6198),t=i(7587),m=i(5861),s=i(9783),g=i(3678),l=i(1720),u=i(5315),_=i(6175),h=i(8655),T=i(3724),z=i(845),y=i(7766),A=i(7758);function Z(e,p){1&e&&t.GkF(0)}function P(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"p-dialog",3),t.NdJ("visibleChange",function(o){return t.CHM(n),t.oxw().modalVisible=o}),t.YNc(1,Z,1,0,"ng-container",4),t.qZA()}if(2&e){const n=t.oxw(),a=t.MAs(3);t.Q6J("header","add"===n.type?"Add Organization":"Edit Organization")("modal",!0)("closable",!n.isSubmitting)("visible",n.modalVisible),t.xp6(1),t.Q6J("ngTemplateOutlet",a)}}function E(e,p){1&e&&t.GkF(0)}function Q(e,p){if(1&e&&(t.ynx(0),t.YNc(1,E,1,0,"ng-container",4),t.BQk()),2&e){t.oxw();const n=t.MAs(3);t.xp6(1),t.Q6J("ngTemplateOutlet",n)}}function w(e,p){if(1&e&&t._UZ(0,"p-message",26),2&e){const n=t.oxw(3);t.Q6J("text",n.error)}}function V(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){return t.CHM(n),t.oxw(3).modalVisible=!1}),t.qZA()}}const H=function(){return{required:!0}},I=function(){return{min:0}};function D(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"app-form",7),t.NdJ("onSubmit",function(o){return t.CHM(n),t.oxw(2).onSubmit(o)}),t.TgZ(1,"app-form-group",8)(2,"app-input",9),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.name=o}),t.qZA(),t.TgZ(3,"app-input",10),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.email=o}),t.qZA(),t.TgZ(4,"app-input",11),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.phoneNo1=o}),t.qZA(),t.TgZ(5,"app-input",12),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.phoneNo2=o}),t.qZA(),t.TgZ(6,"app-input",13),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.openingTime=o}),t.ALo(7,"timeSpan"),t.qZA(),t.TgZ(8,"app-input",14),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.closingTime=o}),t.ALo(9,"timeSpan"),t.qZA()(),t.TgZ(10,"app-form-group",15)(11,"app-input",16),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.country=o}),t.qZA(),t.TgZ(12,"app-input",17),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.province=o}),t.qZA(),t.TgZ(13,"app-input",18),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.city=o}),t.qZA(),t.TgZ(14,"app-input",19),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.streetName=o}),t.qZA(),t.TgZ(15,"app-input",20),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.streetNumber=o}),t.qZA(),t.TgZ(16,"app-input",21),t.NdJ("valueChange",function(o){return t.CHM(n),t.oxw(2).data.postalCode=o}),t.qZA()(),t.YNc(17,w,1,1,"p-message",22),t.TgZ(18,"div",23),t.YNc(19,V,1,0,"button",24),t._UZ(20,"button",25),t.qZA()()}if(2&e){const n=t.oxw(2);t.Q6J("disabled",n.isSubmitting),t.xp6(2),t.Q6J("validations",t.DdM(23,H))("value",n.data.name),t.xp6(1),t.Q6J("value",n.data.email),t.xp6(1),t.Q6J("value",n.data.phoneNo1),t.xp6(1),t.Q6J("value",n.data.phoneNo2),t.xp6(1),t.Q6J("value",t.xi3(7,17,n.data.openingTime,"string")),t.xp6(2),t.Q6J("value",t.xi3(9,20,n.data.closingTime,"string")),t.xp6(3),t.Q6J("value",n.data.country),t.xp6(1),t.Q6J("value",n.data.province),t.xp6(1),t.Q6J("value",n.data.city),t.xp6(1),t.Q6J("value",n.data.streetName),t.xp6(1),t.Q6J("validations",t.DdM(24,I))("value",n.data.streetNumber),t.xp6(1),t.Q6J("value",n.data.postalCode),t.xp6(1),t.Q6J("ngIf",n.error),t.xp6(2),t.Q6J("ngIf",n.modal)}}function B(e,p){if(1&e&&(t.YNc(0,D,21,25,"app-form",5),t._UZ(1,"app-fullscreen-loader",6)),2&e){const n=t.oxw();t.Q6J("ngIf",n.data),t.xp6(1),t.Q6J("visible",n.isSubmitting)}}let O=(()=>{class e{constructor(n){this._organizationsService=n,this.onSubmitSuccess=new t.vpe,this.modal=!1,this.modalVisible=!1,this._isSubmitting=!1}clear(){var n;null===(n=this._form)||void 0===n||n.clearInputs(),this._error=null}onSubmit(n){var a=this;return(0,m.Z)(function*(){if(n.isValid)try{a._isSubmitting=!0,a._error=null;const o=yield a.sendSubmission(a.type,a.data);a.onSubmitSuccess.emit(o)}catch(o){a.showHttpError(o)}finally{a._isSubmitting=!1}})()}sendSubmission(n,a){var o=this;return new Promise(function(){var r=(0,m.Z)(function*(b,x){try{let C=null;switch(n){case"add":C=yield o._organizationsService.addOrganization(a);break;case"edit":C=yield o._organizationsService.updateOrganization(a.id,a);break;default:throw"[FormType] property is invalid"}b(C.body)}catch(C){x(C.error)}});return function(b,x){return r.apply(this,arguments)}}())}showHttpError(n){this._error="string"==typeof n.error?n.error:n.message}get isSubmitting(){return this._isSubmitting}get error(){return this._error}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(l.z))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-organization-form"]],viewQuery:function(n,a){if(1&n&&t.Gf(g.i,5),2&n){let o;t.iGM(o=t.CRH())&&(a._form=o.first)}},inputs:{type:"type",data:"data",modal:"modal",modalVisible:"modalVisible"},outputs:{onSubmitSuccess:"onSubmitSuccess"},decls:4,vars:2,consts:[["styleClass","lg:w-6 lg:h-auto w-11 h-full",3,"header","modal","closable","visible","visibleChange",4,"ngIf"],[4,"ngIf"],["formTemplate",""],["styleClass","lg:w-6 lg:h-auto w-11 h-full",3,"header","modal","closable","visible","visibleChange"],[4,"ngTemplateOutlet"],[3,"disabled","onSubmit",4,"ngIf"],["text","Submitting...",3,"visible"],[3,"disabled","onSubmit"],["headerClass","text-xl font-semibold mb-2","contentClass","grid mb-4","header","General Info"],["name","name","label","Name","labelClass","mb-2 font-semibold",1,"col-6",3,"validations","value","valueChange"],["name","email","type","email","label","Email","labelClass","mb-2 font-semibold",1,"col-6",3,"value","valueChange"],["name","phone-no-1","type","tel","label","Phone No. 1","labelClass","mb-2 font-semibold",1,"col-6",3,"value","valueChange"],["name","phone-no-2","type","tel","label","Phone No. 2","labelClass","mb-2 font-semibold",1,"col-6",3,"value","valueChange"],["name","opening-time","type","time","label","Opening Time","labelClass","mb-2 font-semibold",1,"col-6",3,"value","valueChange"],["name","closing-time","type","time","label","Closing Time","labelClass","mb-2 font-semibold",1,"col-6",3,"value","valueChange"],["headerClass","text-xl font-semibold mb-2","contentClass","grid mb-4","header","Address"],["name","country","label","Country","labelClass","mb-2 font-semibold",1,"col-4",3,"value","valueChange"],["name","province","label","Province","labelClass","mb-2 font-semibold",1,"col-4",3,"value","valueChange"],["name","city","label","City","labelClass","mb-2 font-semibold",1,"col-4",3,"value","valueChange"],["name","street-name","label","Street Name","labelClass","mb-2 font-semibold",1,"col-4",3,"value","valueChange"],["name","street-number","type","number","label","Street Number","labelClass","mb-2 font-semibold",1,"col-4",3,"validations","value","valueChange"],["name","postal-code","label","Postal Code","labelClass","mb-2 font-semibold",1,"col-4",3,"value","valueChange"],["severity","error","styleClass","block mt-4 mb-2",3,"text",4,"ngIf"],["slot","footer",1,"form-actions","text-right"],["pButton","","class","p-button-text","type","button","label","Cancel","icon","pi pi-times",3,"click",4,"ngIf"],["pButton","","type","submit","label","Submit","icon","pi pi-check",1,"p-button-text"],["severity","error","styleClass","block mt-4 mb-2",3,"text"],["pButton","","type","button","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"]],template:function(n,a){1&n&&(t.YNc(0,P,2,5,"p-dialog",0),t.YNc(1,Q,2,1,"ng-container",1),t.YNc(2,B,2,2,"ng-template",null,2,t.W1O)),2&n&&(t.Q6J("ngIf",a.modal),t.xp6(1),t.Q6J("ngIf",!a.modal))},directives:[c.O5,u.V,c.tP,g.i,_.H,h.a,T.q,z.Hq,y.l],pipes:[A.i],styles:["[_nghost-%COMP%]   app-form[_ngcontent-%COMP%]{height:100%}"]}),e})();var $=i(5135),U=i(6709),S=i(7773),F=i(7307);function Y(e,p){if(1&e){const n=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const r=t.CHM(n).$implicit;return t.oxw().onEditOrganization(r)}),t.qZA(),t.TgZ(1,"button",8),t.NdJ("click",function(o){const b=t.CHM(n).$implicit;return t.oxw().onDeleteOrganization(o,b)}),t.qZA()}}let M=(()=>{class e{constructor(n,a,o){this._organizationsService=n,this._messageService=a,this._confirmService=o,this.tableConfig=new $.X({dataKey:"id",cols:[{header:"Name",dataField:"name",sortable:!0,filterable:!0},{header:"Address",dataField:"fullAddress",sortable:!0,filterable:!0}],options:{pagination:{enabled:!0,rows:10}}}),this.loadingVisible=!1}ngOnInit(){this.loadOrganizations()}loadOrganizations(){var n=this;return(0,m.Z)(function*(){try{n.loadingVisible=!0,n.loadingText="Loading organizations...";const a=yield n._organizationsService.getAllOrganizations();n.tableConfig.setData(a.body)}catch(a){n.showHttpError("Failed to Load Organizations",a)}finally{n.loadingVisible=!1}})()}onAddOrganization(){this._organizationForm.clear(),this._organizationForm.data={},this._organizationForm.type="add",this._organizationForm.modalVisible=!0}onEditOrganization(n){this._organizationForm.clear(),setTimeout(()=>{this._organizationForm.data=Object.assign({},n),this._organizationForm.type="edit",this._organizationForm.modalVisible=!0})}onOrganizationFormSuccess(n){this._organizationForm.modalVisible=!1,"add"===this._organizationForm.type?this.tableConfig.addData(n):this.tableConfig.updateFirstWhere(n,a=>a.id===n.id)}onDeleteOrganization(n,a){var o=this;this._confirmService.close(),setTimeout(()=>{var r;this._confirmService.confirm({target:n.target,message:"Are you sure you want to delete this organization?",icon:s.dv.QUESTION,acceptButtonStyleClass:"p-button-danger",accept:(r=(0,m.Z)(function*(){return yield o.deleteOrganization(a)}),function(){return r.apply(this,arguments)})})},135)}deleteOrganization(n){var a=this;return(0,m.Z)(function*(){try{a.loadingText="Deleting organization...",a.loadingVisible=!0,yield a._organizationsService.deleteOrganization(n.id),a.tableConfig.removeFirstWhere(o=>o.id===n.id)}catch(o){a.showHttpError("Failed to Delete Organization",o)}finally{a.loadingVisible=!1}})()}showHttpError(n,a){this._messageService.add({severity:"error",summary:n,detail:"string"==typeof a.error?a.error:a.message,sticky:!0})}get organizations(){return this.tableConfig.data}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(l.z),t.Y36(s.ez),t.Y36(s.YP))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-organizations-table"]],viewQuery:function(n,a){if(1&n&&t.Gf(O,5),2&n){let o;t.iGM(o=t.CRH())&&(a._organizationForm=o.first)}},decls:9,vars:6,consts:[[1,"text-right","mb-3"],["pButton","","label","Add Organization","title","Add Organization","icon","pi pi-building",3,"disabled","click"],[3,"config","rowActionsTemplate"],["actionsTemplate",""],[3,"visible","text"],[3,"modal","onSubmitSuccess"],["position","bottom-right"],["pButton","","icon","pi pi-pencil","title","Edit Organization",1,"mr-2",3,"click"],["pButton","","icon","pi pi-trash","title","Delete Organization",1,"p-button-danger",3,"click"]],template:function(n,a){if(1&n&&(t.TgZ(0,"div",0)(1,"button",1),t.NdJ("click",function(){return a.onAddOrganization()}),t.qZA()(),t.TgZ(2,"app-table",2),t.YNc(3,Y,2,0,"ng-template",null,3,t.W1O),t.qZA(),t._UZ(5,"app-fullscreen-loader",4),t.TgZ(6,"app-organization-form",5),t.NdJ("onSubmitSuccess",function(r){return a.onOrganizationFormSuccess(r)}),t.qZA(),t._UZ(7,"p-toast",6)(8,"p-confirmPopup")),2&n){const o=t.MAs(4);t.xp6(1),t.Q6J("disabled",a.loadingVisible),t.xp6(1),t.Q6J("config",a.tableConfig)("rowActionsTemplate",o),t.xp6(3),t.Q6J("visible",a.loadingVisible)("text",a.loadingText),t.xp6(1),t.Q6J("modal",!0)}},directives:[z.Hq,U.a,y.l,O,S.FN,F.P],styles:["[_nghost-%COMP%]{position:relative;display:flex;flex-direction:column;width:100%;height:100%;padding:20px}"]}),e})();const R=[{path:"",component:(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-organizations"]],decls:1,vars:0,template:function(n,a){1&n&&t._UZ(0,"app-organizations-table")},directives:[M],styles:["[_nghost-%COMP%]{display:block;height:100%}"]}),e})()}];let W=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.Bz.forChild(R)],f.Bz]}),e})();var L=i(7022),J=i(2599),j=i(7665),G=i(5389),K=i(6742);let X=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[s.ez],imports:[[c.ez,G.I,j.g,z.hJ,T.O,J.R,u.S,K.O]]}),e})(),k=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[s.ez,s.YP],imports:[[c.ez,L.U,X,z.hJ,J.R,S.EV,F.n]]}),e})(),q=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[c.ez,W,k]]}),e})()},6742:(v,d,i)=>{i.d(d,{O:()=>m}),i(7758);var f=i(7587);let m=(()=>{class s{}return s.\u0275fac=function(l){return new(l||s)},s.\u0275mod=f.oAB({type:s}),s.\u0275inj=f.cJS({}),s})()},7758:(v,d,i)=>{i.d(d,{i:()=>t});var c=i(5461),f=i(7587);let t=(()=>{class m{transform(g,l){let u;try{const _=c.i.parse(g);if(u=_,null!=l)switch(l){case"string":u=_.toString();break;case"full":u=_.toString(l)}}catch(_){u=null}return u}}return m.\u0275fac=function(g){return new(g||m)},m.\u0275pipe=f.Yjl({name:"timeSpan",type:m,pure:!0}),m})()},5461:(v,d,i)=>{i.d(d,{i:()=>c});class c{constructor(t,m,s){this._hours=0,this._minutes=0,this._seconds=0,this.hours=t,this.minutes=m,this.seconds=s}static parse(t){let m=null;if(t instanceof c)m=t;else{const s=t.split(":");if(s.some(h=>Number.isNaN(h)))throw new Error(`Cannot parse a TimeSpan with given value: "${t}"`);const g=h=>null!=s[h]?Number(s[h]):0,l=g(0),u=g(1),_=g(2);m=new c(l,u,_)}return m}toString(t){let m;return m="full"===t?`${this._hours}hr, ${this._minutes}min, ${this._seconds}sec`:`${this.getValueString(this._hours)}:${this.getValueString(this._minutes)}:${this.getValueString(this._seconds)}`,m}formatValue(t){return t=Number(t),Number.isNaN(t)?0:Math.abs(t)}getValueString(t){return t>9?`${t}`:`0${t}`}get hours(){return this._hours}set hours(t){t=this.formatValue(t),this._hours=t>24?24:t}get minutes(){return this._minutes}set minutes(t){t=this.formatValue(t),this._minutes=t>59?59:t}get seconds(){return this._seconds}set seconds(t){t=this.formatValue(t),this._seconds=t>59?59:t}}}}]);